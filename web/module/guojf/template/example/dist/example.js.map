{"version":3,"file":"example.js","sources":["../../src/utils.js","../../src/index.js","../index.js"],"sourcesContent":["export default {\n    extend(obj1, obj2) {\n        let type = this.isType(obj2);\n        if(type == 'object'){\n            this.forin(obj2, (k,v) => {\n                let vType = this.isType(v);\n                if (vType !== 'object' && vType !== 'array') {\n                    obj1[k] = v;\n                } else {\n                    if (this.isType(obj1[k]) !== vType || obj1[k] === null) {\n                        obj1[k] = vType == 'object' ? {} : [];\n                    }\n                    this.extend(obj1[k], v);\n                }\n            });\n        }else if(type == 'array'){\n            for (let i = 0; i < obj2.length; i++) {\n                obj1[i] = obj2[i];\n            }\n        }else{\n            obj1 = obj2;\n        }\n        return obj1;\n    },\n    loadImage(image, loaded, error) {\n        let img = new Image();\n        if(image.indexOf('http') == 0){\n            img.crossOrigin = '*';\n        }\n        img.onload = () => {\n            loaded(img);\n            setTimeout(()=>{\n                img = null;\n            },1000);\n        };\n        img.onerror = () => {\n            error('img load error');\n        };\n        img.src = image;\n    },\n    isObject(tar){\n        return this.isObjFunc(tar, 'Object');\n    },\n    isBoolean(tar){\n        return this.isObjFunc(tar, 'Boolean');\n    },\n    isArr(tar){\n        return this.isObjFunc(tar, 'Array');\n    },\n    getImage(image,cbk, error){\n        if(typeof image == 'string'){\n                this.loadImage(image, img => {\n                    cbk(img);\n                },error);\n        }else if(typeof image == 'object'){\n            cbk(image);\n        }else{\n            console.log('add image error');\n            return;\n        }\n    },\n    forin(obj,cbk){\n        for(let k in obj){\n            if(obj.hasOwnProperty(k)){\n                cbk(k,obj[k]);\n            }\n        }\n    },\n    isIos8(){\n        let UA = window.navigator.userAgent.toLowerCase();\n        let IOS = /(iPhone|iPad|iPod|iOS)/gi.test(UA);\n        let IPAD = /(iPad)/gi.test(UA);\n        if(IOS){\n            return IPAD ? UA.match(/cpu os (\\d*)/)[1] < 9 : UA.match(/iphone os (\\d*)/)[1] < 9;\n        }else{\n            return false;\n        }\n    },\n    deepCopy(obj){\n        return JSON.parse(JSON.stringify(obj));\n    },\n    isObjFunc(tar, name) {\n        return Object.prototype.toString.call(tar) === '[object ' + name + ']';\n    },\n    isType(tar){\n        return Object.prototype.toString.call(tar).split(' ')[1].replace(']','').toLowerCase();\n    },\n};\n","import _ from './utils';\n\nexport default function MCanvas(options = {}){\n    // 兼容不使用 new 的方式；\n    if (!(this instanceof MCanvas))return new MCanvas(options);\n\n    // 配置canvas初始大小；\n    // width：画布宽度，Number,选填，默认为 500;\n    // height: 画布高度，Number，选填，默认与宽度一致；\n    this.ops = _.extend({\n        width: 500,\n        height: 500,\n        backgroundColor : '',\n    }, options);\n\n    // 全局画布；\n    this.canvas = null;\n    this.ctx = null;\n    // 绘制函数队列；\n    this.queue = [];\n    // 回调函数池；\n    this.fn = {\n        // 最后执行的函数；\n        success(){},\n        // 错误回调；\n        error(){},\n    };\n    this.data = {\n        // 文字id；\n        textId: 0,\n        // 文字绘制数据；\n        text : {},\n        // 背景图数据;\n        bgConfig : null,\n    };\n\n    // 初始化创建画布；\n    this._init();\n}\n\nMCanvas.prototype._init = function(){\n    this.canvas = document.createElement('canvas');\n    this.canvas.width = this.ops.width;\n    this.canvas.height = this.ops.height;\n    this.ctx = this.canvas.getContext('2d');\n    this.ctx.save();\n\n    this.ops.backgroundColor && this.setBgColor(this.ops.backgroundColor);\n};\n\n// --------------------------------------------------------\n// 绘制背景部分；\n// --------------------------------------------------------\n\nMCanvas.prototype.background = function(image, bg = {\n    type : 'origin',\n}){\n    if(!image && !this.data.bgConfig){\n        console.error('mcanvas error : the init background must has a image.');\n        return;\n    }\n\n    // 缓存bg options， 用于重置；\n    if(!image){\n        bg = this.data.bgConfig;\n    }else{\n        bg.image = image;\n        this.data.bgConfig = bg;\n    }\n\n    this.queue.push(() => {\n        if(bg.color)this.setBgColor(bg.color);\n        _.getImage(bg.image, img =>{\n            this._background(img, bg);\n        },this.fn.error);\n    });\n    return this;\n};\n\n// 设置画布颜色;\nMCanvas.prototype.setBgColor = function(color){\n    this.ctx.fillStyle = color;\n    this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height);\n};\n\nMCanvas.prototype._getBgAlign = function(left,iw,cw,cropScale){\n    let rv;\n    if(typeof left == 'string'){\n        if(left == '50%' || left == 'center'){\n            rv = Math.abs((iw - cw / cropScale) / 2);\n        }else if(left == '100%'){\n            rv = Math.abs(iw - cw / cropScale);\n        }else if(left == '0%'){\n            rv = 0;\n        }\n    }else if(typeof left == 'number'){\n        rv = left;\n    }else{\n        rv = 0;\n    }\n    return rv;\n};\nMCanvas.prototype._background = function(img, bg){\n    let { iw, ih } = this._getSize(img);\n    // 图片与canvas的长宽比；\n    let iRatio = iw / ih;\n    let cRatio = this.canvas.width / this.canvas.height;\n    // 背景绘制参数；\n    let sx,sy,swidth,sheight,dx,dy,dwidth,dheight;\n    let cropScale;\n    switch (bg.type) {\n        // 裁剪模式，固定canvas大小，原图铺满，超出的部分裁剪；\n        case 'crop':\n            if(iRatio > cRatio){\n                swidth = ih * cRatio;\n                sheight = ih;\n                cropScale = this.canvas.height / ih;\n            }else{\n                swidth = iw;\n                sheight = swidth / cRatio;\n                cropScale = this.canvas.width / iw;\n            }\n\n            sx = this._getBgAlign(bg.left,iw, this.canvas.width,cropScale);\n            sy = this._getBgAlign(bg.top,ih,this.canvas.height,cropScale);\n\n            dy = dx = 0;\n            dheight = this.canvas.height;\n            dwidth = this.canvas.width;\n            break;\n        // 包含模式，固定canvas大小，包含背景图；\n        case 'contain':\n            sy = sx = 0;\n            swidth = iw;\n            sheight = ih;\n            if(iRatio > cRatio){\n                dwidth = this.canvas.width;\n                dheight = dwidth / iRatio;\n                dx = bg.left || 0;\n                dy = (bg.top || bg.top == 0) ? bg.top : (this.canvas.height - dheight)/2;\n            }else{\n                dheight = this.canvas.height;\n                dwidth = dheight * iRatio;\n                dy = bg.top || 0;\n                dx = (bg.left || bg.left == 0) ? bg.left : (this.canvas.width - dwidth)/2;\n            }\n            break;\n        // 原图模式：canvas与原图大小一致，忽略初始化 传入的宽高参数；\n        // 同时，background 传入的 left/top 均被忽略；\n        case 'origin':\n            this.canvas.width = iw;\n            this.canvas.height = ih;\n            sx = sy = 0;\n            swidth = iw;\n            sheight = ih;\n            dx = dy = 0;\n            dwidth = this.canvas.width;\n            dheight = this.canvas.height;\n            break;\n        default:\n            console.error('mcanvas error:background type error!');\n            return;\n    }\n    this.ctx.drawImage(img,sx,sy,swidth,sheight,dx,dy,dwidth,dheight);\n    this._next();\n};\n// --------------------------------------------------------\n// 绘制图层部分；\n// --------------------------------------------------------\n\n// 绘制矩形层；\nMCanvas.prototype.rect = function(ops){\n    this.queue.push(() => {\n        let { fillColor = '#fff', strokeColor = fillColor, strokeWidth = 0} = ops;\n        let cw = this.canvas.width , ch = this.canvas.height;\n        let width = this._get(cw, 0, ops.width || 0, 'pos') - 2 * strokeWidth,\n            height = this._get(ch, 0, ops.height || 0, 'pos') - 2 * strokeWidth;\n        let x = this._get(cw, width, ops.x || 0 ,'pos') + strokeWidth / 2,\n            y = this._get(ch, height, ops.y || 0 ,'pos') + strokeWidth / 2;\n        this.ctx.lineWidth = strokeWidth;\n        this.ctx.fillStyle = fillColor;\n        this.ctx.strokeStyle = strokeColor;\n\n        this.ctx.beginPath();\n        this.ctx.strokeRect(x, y, width, height);\n        this.ctx.fillRect(x, y, width, height);\n        this.ctx.closePath();\n\n        this._resetCtx()._next();\n    });\n    return this;\n};\n\n// 绘制圆形层；\nMCanvas.prototype.circle = function(ops){\n    this.queue.push(() => {\n        let { fillColor = '#fff', strokeColor = fillColor, strokeWidth = 0 } = ops;\n        let cw = this.canvas.width , ch = this.canvas.height;\n        let r = this._get(cw, 0, ops.r || 0, 'pos') - 2 * strokeWidth;\n        let x = this._get(cw, 2 * r, ops.x || 0 ,'pos') + strokeWidth / 2 + r,\n            y = this._get(ch, 2 * r, ops.y || 0 ,'pos') + strokeWidth / 2 + r;\n\n        this.ctx.beginPath();\n        this.ctx.arc(x,y,r,0,Math.PI*2,false);\n        this.ctx.fillStyle = fillColor;\n        this.ctx.fill();\n        this.ctx.strokeStyle = strokeColor;\n        this.ctx.lineWidth = strokeWidth;\n        this.ctx.stroke();\n        this.ctx.closePath();\n\n        this._resetCtx()._next();\n    });\n    return this;\n};\n\n// 重置ctx属性;\nMCanvas.prototype._resetCtx = function(){\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0);\n    this.ctx.restore();\n    return this;\n};\n\n// 绘制水印；基于 add 函数封装；\nMCanvas.prototype.watermark = function(image = '', ops){\n    if(!image){\n        console.error('mcanvas error : there is not image of watermark.');\n        return;\n    }\n    // 参数默认值；\n    let { width = '40%' , pos = 'rightbottom' , margin = 20 } = ops;\n    let position = {\n        x:0,\n        y:0,\n        scale:1,\n        rotate:0,\n    };\n    switch (pos) {\n        case 'leftTop':\n            position.x = `left:${margin}`;\n            position.y = `top:${margin}`;\n            break;\n        case 'leftBottom':\n            position.x = `left:${margin}`;\n            position.y = `bottom:${margin}`;\n            break;\n        case 'rightTop':\n            position.x = `right:${margin}`;\n            position.y = `top:${margin}`;\n            break;\n        case 'rightBottom':\n            position.x = `right:${margin}`;\n            position.y = `bottom:${margin}`;\n            break;\n        default:\n    }\n    this.add(image,{\n        width,\n        pos:position,\n    });\n    return this;\n};\n\n// 通用绘制图层函数；\n// 使用方式：\n// 多张图: add([{image:'',options:{}},{image:'',options:{}}]);\n// 单张图: add(image,options);\nMCanvas.prototype.add = function(image = '',options){\n    // 默认参数；\n    let def = {\n        width:'100%',\n        crop:{\n            x:0,\n            y:0,\n            width:'100%',\n            height:'100%',\n        },\n        pos:{\n            x:0,\n            y:0,\n            scale:1,\n            rotate:0,\n        },\n    };\n\n    if(!_.isArr(image))image = [{image,options}];\n\n    image.forEach( v =>{\n        // 将封装好的 add函数 推入队列中待执行；\n        // 参数经过 _handleOps 加工；\n        this.queue.push(() => {\n            _.getImage(v.image, img => {\n                this._add(img,this._handleOps(_.extend(def,v.options),img));\n            },this.fn.error);\n        });\n    });\n\n    return this;\n};\n\nMCanvas.prototype._add = function(img,ops){\n    if(ops.width == 0)console.warn(`mcanvas warn: the width of mc-element is zero`);\n    let { iw, ih } = this._getSize(img);\n    // let ratio = iw / ih;\n    // 画布canvas参数；\n    let cdx,cdy,cdw,cdh;\n    // 素材canvas参数；\n    let { x:lsx, y:lsy, width:lsw, height:lsh } = ops.crop;\n\n    let cratio = lsw / lsh;\n    let ldx,ldy,ldw,ldh;\n    // 素材canvas的绘制;\n    let lcvs = document.createElement('canvas');\n    let lctx = lcvs.getContext('2d');\n    // 图片宽高比 * 1.4 是一个最安全的宽度，旋转任意角度都不会被裁剪；\n    // 没有旋转却长宽比很高大的图，会导致放大倍数太大，因此甚至了最高倍数为5；\n    // _ratio 为 较大边 / 较小边 的比例；\n    let _ratio = iw > ih ? iw / ih : ih / iw;\n    let lctxScale = _ratio * 1.4 > 5 ? 5 : _ratio * 1.4;\n    let spaceX,spaceY;\n\n    lcvs.width =  lsw * lctxScale;\n    lcvs.height = lsh * lctxScale;\n\n    // 限制canvas的大小，ios8以下为 2096, 其余平台均限制为 4096;\n    let shrink;\n    if(_.isIos8() && (lcvs.width > 2096 || lcvs.height > 2096)){\n        if(cratio > 1){\n            shrink = 2096 / lcvs.width;\n        }else{\n            shrink = 2096 / lcvs.height;\n        }\n    }else if(lcvs.width > 4096 || lcvs.height > 4096){\n        if(cratio > 1){\n            shrink = 4096 / lcvs.width;\n        }else{\n            shrink = 4096 / lcvs.height;\n        }\n    }\n\n    // 从素材canvas的中心点开始绘制；\n    ldx = - Math.round(lsw / 2);\n    ldy = - Math.round(lsh / 2);\n    ldw = lsw;\n    ldh = Math.round(lsw / cratio);\n\n    // 获取素材最终的宽高;\n    if(shrink){\n        [lcvs.width,lcvs.height,ldx,ldy,ldw,ldh] = [lcvs.width,lcvs.height,ldx,ldy,ldw,ldh].map(v => Math.round(v*shrink));\n    }\n\n    lctx.translate(lcvs.width/2,lcvs.height/2);\n    lctx.rotate(ops.pos.rotate);\n    \n    lctx.drawImage(img,lsx,lsy,lsw,lsh,ldx,ldy,ldw,ldh);\n\n    // lcvs.style.width = '300px';\n    // document.querySelector('body').appendChild(lcvs);\n\n    cdw = ops.width * lctxScale;\n    cdh = cdw / cratio;\n\n    spaceX = (lctxScale - 1) * ops.width / 2;\n    spaceY = spaceX / cratio;\n\n    // 获取素材的位置；\n    //    配置的位置 - 缩放的影响 - 绘制成正方形的影响；\n    cdx = ops.pos.x + cdw * ( 1 - ops.pos.scale )/2 - spaceX;\n    cdy = ops.pos.y + cdh * ( 1 - ops.pos.scale )/2 - spaceY;\n\n    cdw *= ops.pos.scale;\n    cdh *= ops.pos.scale;\n\n    this.ctx.drawImage(lcvs,cdx,cdy,cdw,cdh);\n\n    lcvs = lctx = null;\n    this._next();\n};\n\n// 获取宽高，兼容img，canvas\nMCanvas.prototype._getSize = function(img){\n    let iw, ih;\n    if(img.tagName === 'IMG'){\n        iw = img.naturalWidth;\n        ih = img.naturalHeight;\n    }else if(img.tagName === 'CANVAS'){\n        iw = img.width;\n        ih = img.height;\n    }else{\n        iw = img.offsetWidth;\n        ih = img.offsetHeight;\n    }\n    return { iw, ih };\n};\n// 参数加工函数；\nMCanvas.prototype._handleOps = function(ops,img){\n    let cw = this.canvas.width,\n        ch = this.canvas.height;\n    let { iw, ih } = this._getSize(img);\n\n    // 图片宽高比；\n    let ratio = iw / ih;\n\n    // 根据参数计算后的绘制宽度；\n    let width =  this._get(cw,iw,ops.width,'pos');\n\n    // 裁剪的最大宽高；\n    let maxLsw,maxLsh;\n\n    // 裁剪参数；\n    let { x:cropx,y:cropy,width:cropw,height:croph } = ops.crop;\n    let crop = {};\n    crop.width = this._get(cw,iw,cropw,'crop');\n    crop.height = this._get(ch,ih,croph,'crop');\n    crop.x = this._get(iw,crop.width,cropx,'crop');\n    crop.y = this._get(ih,crop.height,cropy,'crop');\n\n    // 最大值判定；\n    if(crop.x > iw)crop.x = iw;\n    if(crop.y > ih)crop.y = ih;\n    maxLsw = iw - crop.x;\n    maxLsh = ih - crop.y;\n    if(crop.width > maxLsw)crop.width = maxLsw;\n    if(crop.height > maxLsh)crop.height = maxLsh;\n\n    // 位置参数；\n    let { x: px, y: py, rotate: pr, scale: ps } = ops.pos;\n    let pos = {\n        x:this._get(cw,width,px,'pos'),\n        y:this._get(ch,width/ratio,py,'pos'),\n        scale : ps,\n        rotate : parseFloat(pr) * Math.PI / 180,\n    };\n    return {width,crop,pos};\n};\n\n// --------------------------------------------------------\n// 绘制文字部分；\n// --------------------------------------------------------\nMCanvas.prototype.text = function(context = '', ops){\n    // 默认字体；\n    let fontFamily = `helvetica neue,hiragino sans gb,Microsoft YaHei,arial,tahoma,sans-serif`;\n    // 默认的字体大小;\n    let size = this.canvas.width / 20;\n\n    this.queue.push(()=>{\n        let defaultStyle = {\n            color:'#000',\n            type : 'fill',   // strokeText or fillText,\n            lineWidth : 1,\n            shadow:{\n                color: null,\n                blur: 0,\n                offsetX: 0,\n                offsetY: 0,\n            },\n        };\n        let option = {\n            width : 300,\n            align : 'left',\n            smallStyle:{\n                font : `${size * 0.8}px ${fontFamily}`,\n                lineHeight:size * 0.9,\n                ..._.deepCopy(defaultStyle),\n            },\n            normalStyle:{\n                font : `${size}px ${fontFamily}`,\n                lineHeight:size*1.1,\n                type : 'fill',   // strokeText or fillText,\n                ..._.deepCopy(defaultStyle),\n            },\n            largeStyle:{\n                font : `${size * 1.3}px ${fontFamily}`,\n                lineHeight:size * 1.4,\n                ..._.deepCopy(defaultStyle),\n            },\n            pos:{\n                x:0,\n                y:0,\n                rotate: 0,\n            },\n        };\n\n        option = _.extend(option,ops);\n\n        // 解析字符串模板后，调用字体绘制函数；\n        let parseContext = this._parse(context);\n        let max = 0, maxFont;\n        parseContext.map(v => {\n            if (v.size > max) {\n                max = v.size;\n                maxFont = v.type;\n            }\n        });\n        // 当设置的宽度小于字体宽度时，强行将设置宽度设为与字体一致；\n        let maxFontSize = parseInt(option[`${maxFont}Style`].font);\n        if (maxFontSize && option.width < maxFontSize) option.width = maxFontSize;\n\n        this._text(parseContext, option);\n        this._resetCtx()._next();\n    });\n    return this;\n};\n// 字符串模板解析函数\n// 解析 <s></s> <b></b>\nMCanvas.prototype._parse = function(context){\n    let arr = context.split(/<s>|<b>/);\n    let result = [];\n    for(let i= 0;i<arr.length;i++){\n        let value = arr[i];\n        if(/<\\/s>|<\\/b>/.test(value)){\n            let splitTag = /<\\/s>/.test(value) ? '</s>' : '</b>',\n                type     = /<\\/s>/.test(value) ? 'small' : 'large';\n            let tmp = arr[i].split(splitTag);\n            result.push({\n                type,\n                text:tmp[0],\n                // 用于字体的大小比较；\n                size: type == 'small' ? 0 : 2,\n            });\n            tmp[1] && result.push({\n                type:'normal',\n                text:tmp[1],\n                size: 1,\n            });\n            continue;\n        }\n        arr[i] && result.push({\n            text:arr[i],\n            type:'normal',\n            size: 1,\n        });\n    }\n    return result;\n};\n\nMCanvas.prototype._text = function(textArr,option){\n\n    this.data.textId++;\n    this.data.text[this.data.textId] = {};\n\n    // 处理宽度参数；\n    option.width = this._get(this.canvas.width,0,option.width,'pos');\n\n    let style, line = 1, length = 0,\n        lineHeight = getLineHeight(textArr,option),\n        x = this._get(this.canvas.width,option.width,0 ,'pos'),\n        y = (this._get(this.canvas.height,0 ,0 ,'pos')) + lineHeight;\n\n    // data:字体数据；\n    // lineWidth:行宽；\n    this.data.text[this.data.textId][line] = {\n        data:[],\n        lineWidth:0,\n    };\n\n    // 生成字体数据；\n    textArr.forEach(v =>{\n        style = option[`${v.type}Style`];\n        this.ctx.font = style.font;\n        let width = this.ctx.measureText(v.text).width;\n\n        // 处理 <br> 换行，先替换成 '|',便于单字绘图时进行判断；\n        let context = v.text.replace(/<br>/g,'|');\n\n        // 先进行多字超出判断，超出宽度后再进行单字超出判断；\n        if((length + width) > option.width || context.indexOf('|') !== -1){\n            for (let i = 0,fontLength = context.length; i < fontLength; i++) {\n                let font = context[i];\n                width = this.ctx.measureText(font).width;\n\n                // 当字体的计算宽度 > 设置的宽度 || 内容中包含换行时,进入换行逻辑；\n                if((length + width) > option.width || font == '|'){\n                    length = 0;\n                    x = this._get(this.canvas.width,option.width, 0, 'pos');\n                    y += lineHeight;\n                    line += 1;\n                    this.data.text[this.data.textId][line] = {\n                        data:[],\n                        lineWidth:0,\n                    };\n                    if(font == '|')continue;\n                }\n                this.data.text[this.data.textId][line]['data'].push({\n                    context:font,x,y,style,width,\n                });\n                length += width;\n                x += width;\n                this.data.text[this.data.textId][line]['lineWidth'] = length;\n            }\n        }else{\n            this.data.text[this.data.textId][line]['data'].push({\n                context,x,y,style,width,\n            });\n            length += width;\n            x += width;\n            this.data.text[this.data.textId][line]['lineWidth'] = length;\n        }\n    });\n\n    // 创建文字画布；\n    const tcvs = document.createElement('canvas');\n    const tctx = tcvs.getContext('2d');\n    const tdx = this._get(this.canvas.width,option.width,option.pos.x ,'pos'), \n          tdy = this._get(this.canvas.height,0 ,option.pos.y ,'pos');\n    let tdw, tdh;\n    tdw = tcvs.width = option.width;\n    tdh = tcvs.height = this._getTextRectHeight(line);\n        \n    // 通过字体数据进行文字的绘制；\n    _.forin(this.data.text[this.data.textId],(k,v)=>{\n        // \b增加 align 的功能；\n        let add = 0;\n        if(v.lineWidth < option.width){\n            if(option.align == 'center'){\n                add = (option.width - v.lineWidth)/2;\n            }else if (option.align == 'right') {\n                add = option.width - v.lineWidth;\n            }\n        }\n        v.data.forEach(text=>{\n            text.x += add;\n            this._fillText(tctx, text);\n        });\n    });\n\n    // tcvs.style.width = '300px';\n    // document.querySelector('body').appendChild(tcvs);\n    \n    // 绘制文字画布；\n    const originX = tdx + tdw/2,\n          originY = tdy + tdh/2;\n    this.ctx.translate(originX, originY);\n    this.ctx.rotate(parseFloat(option.pos.rotate) * Math.PI / 180);\n    this.ctx.drawImage(tcvs,-tdw/2, -tdh/2, tdw, tdh);\n\n    // 获取行高；\n    function getLineHeight(textArr,option) {\n        let lh = 0,vlh;\n        textArr.forEach( v =>{\n            vlh = option[`${v.type}Style`].lineHeight;\n            if(vlh > lh)lh = vlh;\n        });\n        return lh;\n    }\n};\n\nMCanvas.prototype._fillText = function(ctx, text){\n    let {context, x, y, style} = text;\n    let {align, lineWidth, shadow} = style;\n    let {color, blur, offsetX, offsetY} = shadow;\n    ctx.font = style.font;\n    ctx.textAlign = align;\n    ctx.textBaseline = 'alphabetic';\n    ctx.lineWidth = lineWidth;\n    ctx.shadowColor = color;\n    ctx.shadowBlur = blur;\n    ctx.shadowOffsetX = offsetX;\n    ctx.shadowOffsetY = offsetY;\n\n    if(style.gradient){\n        let { type, colorStop } = style.gradient;\n        let x1, y1, x2, y2;\n        if(type == 1){\n            x1 = x; y1 = y;\n            x2 = x + text.width; y2 = y ;\n        }else{\n            x1 = x; y1 = y - style.lineHeight;\n            x2 = x; y2 = y;\n        }\n        let grad  = ctx.createLinearGradient(x1,y1,x2,y2);\n        let colorNum = colorStop.length || 0;\n        _.forin(colorStop, (i, v)=>{\n            grad.addColorStop(1/colorNum*(+i+1),v);\n        });\n        ctx[`${style.type}Style`] = grad;\n    }else{\n        ctx[`${style.type}Style`] = style.color;\n    }\n\n    ctx[`${style.type}Text`](context,x,y);\n    this._resetCtx();\n};\n\nMCanvas.prototype._getTextRectHeight = function (lastLine) {\n    const lastLineData = this.data.text[this.data.textId][lastLine].data[0];\n    return lastLineData.y + lastLineData.style.lineHeight;\n};\n\n// --------------------------------------------------------\n// 业务功能函数部分\n// --------------------------------------------------------\n\n// 参数加工函数；\n// 兼容 5 种 value 值：\n// x:250, x:'250px', x:'100%', x:'left:250',x:'center',\n// width:100,width:'100px',width:'100%'\nMCanvas.prototype._get = function(par,child,str,type){\n    let result = str;\n    if(typeof str === 'string'){\n        if(str.indexOf(':') !== -1 && type == 'pos'){\n            let arr = str.split(':');\n            switch (arr[0]) {\n                case 'left':\n                case 'top':\n                    result = +(arr[1].replace('px',''));\n                    break;\n                case 'right':\n                case 'bottom':\n                    result = par - (+(arr[1].replace('px',''))) - child;\n                    break;\n                default:\n            }\n        }else if (str.indexOf('px') !== -1) {\n            result = (+str.replace('px', ''));\n        } else if (str.indexOf('%') !== -1) {\n            if(type == 'crop'){\n                result = child * (+str.replace('%', '')) / 100;\n            }else{\n                result = par * (+str.replace('%', '')) / 100;\n            }\n        } else if (str == 'center'){\n            result = (par-child)/2;\n        } else if (str == 'origin') {\n            result = child;\n        } else {\n            result = +str;\n        }\n    }\n    return Math.round(result);\n};\n\n// 绘制函数；\nMCanvas.prototype.draw = function(ops){\n    let _ops = {\n        type:'jpg',\n        quality:.9,\n        success(){},\n        error(){},\n    }, b64;\n    if(typeof ops == 'function'){\n        _ops.success = ops;\n    }else{\n        _ops = _.extend(_ops,ops);\n        if(_ops.type == 'jpg')_ops.type = 'jpeg';\n    }\n    this.fn.error = _ops.error;\n    this.fn.success = () => {\n        setTimeout(()=>{\n            b64 = this.canvas.toDataURL(`image/${_ops.type}`, _ops.quality);\n            _ops.success(b64);\n        },0);\n    };\n    this._next();\n    return this;\n};\n\nMCanvas.prototype._next = function(){\n    if(this.queue.length > 0){\n        this.queue.shift()();\n    }else{\n        this.fn.success();\n    }\n};\n\nMCanvas.prototype.clear = function(){\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n    return this;\n};\n","import MCanvas from '../src/index';\n\nlet $sure = $('.js-sure');\nlet $params = $('.js-params');\nlet $dialog = $('.js-dialog');\nlet $result = $('.js-result');\nlet $cancel = $('.js-cancel');\nlet $clear = $('.js-clear');\n\nlet data = {\n    addImageOps : {\n        image:'./images/ear.png',\n        // image:'https://mtapplet.meitudata.com/59c8c479521876738.jpg',\n        options:{\n            width:482,\n            pos:{\n                x:150,\n                y:58,\n                scale:1,\n                rotate:1,\n            },\n        },\n    },\n    addWmOps : {\n        image:'images/watermark.jpg',\n        options:{\n            width:'40%',\n            pos:'rightBottom',\n        },\n    },\n    addRectOps:{\n        x: 0,\n        y: 'bottom:0',\n        width: '100%',\n        height: 300,\n        strokeWidth : 5,\n        strokeColor: '#996699',\n        fillColor: 'rgba(0,0,0,.5)',\n    },\n    addCircleOps:{\n        x: 'center',\n        y: 'center',\n        r: 100,\n        strokeWidth : 5,\n        strokeColor: '#996699',\n        fillColor: 'rgba(0,0,0,.5)',\n    },\n    addTextOps : {\n        // text:'<b>A</b>BBBBB<s>MCanvas.js</s>',\n        text:'<b>Large/Stroke</b><br>Normal/Gradient<br><s>Small/Shadow</s>',\n        options:{\n            width:'600',\n            align:'center',\n            largeStyle:{\n                color:'red',\n                font: '90px Microsoft YaHei,sans-serif',\n                type: 'stroke',\n                lineWidth: 2,\n                lineHeight : 90,\n            },\n            normalStyle:{\n                color:'blue',\n                font:'70px Microsoft YaHei,sans-serif',\n                lineHeight : 70,\n                // shadow:{\n                //     color: 'red',\n                //     blur: 4,\n                //     offsetX: 2,\n                //     offsetY: 2,\n                // },\n                gradient:{\n                    type: 2,  // 1: 横向渐变； 2: 纵向渐变；\n                    colorStop: ['red','blue'],\n                },\n            },\n            smallStyle:{\n                color:'yellow',\n                font:'50px Microsoft YaHei,sans-serif',\n                lineHeight : 50,\n                shadow:{\n                    color: 'red',\n                    blur: 10,\n                    offsetX: 5,\n                    offsetY: 5,\n                },\n            },\n            pos:{\n                x:'center',\n                y:'bottom:400',\n                rotate: 0,\n            },\n        },\n    },\n};\n\nlet mc = new MCanvas({\n    width: 1000,\n    height: 1500,\n    // backgroundColor: 'black',\n});\nmc.background('http://mtapplet.meitudata.com/596c72073971d86b5128.jpg',{\n// mc.background('http://mtapplet.meitudata.com/59e8765b6492c541.jpg',{\n    type:'origin',\n    left:'50%',\n    top:'50%',\n});\n\nlet timer;\n$('.Button').on('touchstart',function(){\n    $(this).addClass('taped');\n    timer = setTimeout(()=>{\n        $(this).removeClass('taped');\n    },2000);\n});\n$('.Button').on('touchend',function(){\n    $(this).removeClass('taped');\n    clearTimeout(timer);\n});\n\n$cancel.on('click',()=>{\n    $dialog.hide();\n});\n\n$clear.on('click',()=>{\n    // mc.clear();\n    mc.background().clear().draw(b64=>{\n        $result.attr('src',b64);\n    });\n});\n\n$('.js-addImage').on('click',()=>{\n    let type = `image`;\n    showDialog(type,data.addImageOps);\n});\n\n$('.js-addWm').on('click',()=>{\n    let type = `watermark`;\n    showDialog(type,data.addWmOps);\n});\n\n$('.js-addText').on('click',()=>{\n    let type = `text`;\n    showDialog(type,data.addTextOps);\n});\n\n$('.js-addRect').on('click',()=>{\n    mcDraw(data.addRectOps, 'rect');\n});\n\n$('.js-addCircle').on('click',()=>{\n    mcDraw(data.addCircleOps, 'circle');\n});\n\n$sure.on('click',function(){\n    let ops = $(this).data('ops');\n    let type = $(this).data('type');\n    mcDraw(ops,type);\n});\n\nfunction mcDraw(ops,type){\n    let img;\n    switch (type) {\n        case `image`:\n            img = new Image();\n            img.crossOrigin = '*';\n            img.onload = function(){\n                mc.add(img,ops.options).draw({\n                    type:'jpg',\n                    quality:.9,\n                    success(b64){\n                        $result.attr('src',b64);\n                        $dialog.hide();\n                    },\n                    error(err){\n                        console.log('error', err);\n                    },\n                });\n            };\n            img.src = ops.image;\n            break;\n        case `watermark`:\n            mc.watermark(ops.image,ops.options).draw(b64=>{\n                $result.attr('src',b64);\n                $dialog.hide();\n            });\n            break;\n        case `text`:\n            mc.text(ops.text,ops.options).draw(b64=>{\n                $result.attr('src',b64);\n                $dialog.hide();\n            });\n            break;\n        case `rect`:\n            mc.rect(ops).draw(b64=>{\n                $result.attr('src',b64);\n                $dialog.hide();\n            });\n            break;\n        case `circle`:\n            mc.circle(ops).draw(b64=>{\n                $result.attr('src',b64);\n                $dialog.hide();\n            });\n            break;\n        default:\n    }\n\n}\n\nfunction showDialog(type,ops){\n    let tab = `&nbsp;&nbsp;&nbsp;&nbsp;`;\n    let html;\n    switch (type) {\n        case 'image':\n            html = `<li>image:'${ops.image}'</li>\n                    <li>options:{</li>\n                    <li>${tab}width:<input data-type='width' class='js-input input' type='text' value='${ops.options.width}'></li>\n                    <li>${tab}pos:{</li>\n                    <li>${tab+tab}x:<input data-type='x' class='js-input input' type='text' value='${ops.options.pos.x}'></li>\n                    <li>${tab+tab}y:<input data-type='y' class='js-input input' type='text' value='${ops.options.pos.y}'></li>\n                    <li>${tab+tab}scale:<input data-type='scale' class='js-input input' type='text' value='${ops.options.pos.scale}'></li>\n                    <li>${tab+tab}rotate:<input data-type='rotate' class='js-input input' type='text' value='${ops.options.pos.rotate}'></li>\n                    <li>${tab}}</li>\n                    <li>}</li>`;\n            break;\n        case 'watermark':\n            html = `<li>image:'${ops.image}'</li>\n                    <li>options:{</li>\n                    <li>${tab}width:<input data-type='width' class='js-input input' type='text' value='${ops.options.width}'></li>\n                    <li>${tab}pos:\n                        <select data-type='pos' class='js-select select'>\n                            <option>rightBottom</option>\n                            <option>rightTop</option>\n                            <option>leftBottom</option>\n                            <option>leftTop</option>\n                        </select>\n                    <li>}</li>`;\n            break;\n        case 'text':\n            html = `<li>text:<span style=\"font-size:12px;\">''&lt;b&gt;Large/Stroke&lt;/b&gt;Normal/Gradient&lt;s&gt;Small/Shadow&lt;/s&gt;''</span></li>\n                    <li>options:{</li>\n                    <li>${tab}width:<input data-type='width' class='js-input input' type='text' value='${ops.options.width}'></li>\n                    <li>${tab}align:\n                        <select data-type='align' class='js-select select'>\n                            <option>left</option>\n                            <option>center</option>\n                            <option>right</option>\n                        </select>\n                    </li>\n                    <li>${tab}pos:{\n                    <li>${tab+tab}x:<input data-type='x' class='js-input input' type='text' value='${ops.options.pos.x}'></li>\n                    <li>${tab+tab}y:<input data-type='y' class='js-input input' type='text' value='${ops.options.pos.y}'></li>\n                    <li>${tab}}</li>\n                    <li>}</li>`;\n            break;\n        default:\n    }\n    $params.html(html);\n    $sure.data('ops',JSON.stringify(ops)).data('type',type);\n    $dialog.show();\n}\n\n$(window).on('input','.js-input',function(){\n    let $this = $(this);\n    let v = $this.val();\n    let type = $this.data('type');\n    let ops = $sure.data('ops');\n    switch (type) {\n        case 'width':\n            ops.options.width = v;\n            break;\n        case 'x':\n            ops.options.pos.x = v;\n            break;\n        case 'y':\n            ops.options.pos.y = v;\n            break;\n        case 'scale':\n            ops.options.pos.scale = v;\n            break;\n        case 'rotate':\n            ops.options.pos.rotate = v;\n            break;\n        case 'align':\n            ops.options.align = v;\n            break;\n        default:\n    }\n    $sure.data('ops',JSON.stringify(ops));\n});\n\n$(window).on('focus','.js-input',function(){\n    $(this).addClass('focus');\n});\n$(window).on('blur','.js-input',function(){\n    $(this).removeClass('focus');\n});\n\n$(window).on('change','.js-select',function(){\n    let ops = $sure.data('ops');\n    let type = $(this).data('type');\n    ops.options[type] = $(this).val();\n    $sure.data('ops',JSON.stringify(ops));\n});\n\n// let mc1 = new MCanvas({\n//     width: 750,\n//     height: 1143,\n// });\n// mc1.background('images/share-bg.jpg', {\n//     width: '100%',\n//     type: 'origin',\n// }).add('http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLvbgsiba9Ruka9ryibevLia9c6RBhtOOztTgPQeSLdPwfaGIKHMxRNiam6VyuNictTib4fYRD1CNJZia2gQ/132', {\n//     width: 171,\n//     pos: {\n//         x: 280,\n//         y: 329,\n//     },\n// }).add('images/mask.png', {\n//     width: 216,\n//     pos: {\n//         x: 238,\n//         y: 323,\n//     },\n// }).text('班主任指着XX对全班说：你们要记住他，毕业之后就没有机会遇到这么优秀的人了！', {\n//     width: 442,\n//     align: 'left',\n//     normalStyle: {\n//         color: '#000',\n//         font: '30px Microsoft YaHei,sans-serif',\n//         lineHeight : 40,\n//     },\n//     pos: {\n//         x: 'center',\n//         y: 766,\n//     },\n// }).text('内秀30%', {\n//     width: 145,\n//     align: 'left',\n//     normalStyle: {\n//         color: '#000',\n//         font: '24px Microsoft YaHei,sans-serif',\n//     },\n//     pos: {\n//         x: 110,\n//         y: 323,\n//     },\n// }).text('未知属性3%', {\n//     width: 180,\n//     align: 'left',\n//     normalStyle: {\n//         color: '#000',\n//         font: '24px Microsoft YaHei,sans-serif',\n//     },\n//     pos: {\n//         x: 460,\n//         y: 264,\n//     },\n// }).text('外秀67%', {\n//     width: 180,\n//     align: 'left',\n//     normalStyle: {\n//         color: '#000',\n//         font: '24px Microsoft YaHei,sans-serif',\n//     },\n//     pos: {\n//         x: 490,\n//         y: 470,\n//     },\n// }).text('黄明照', {\n//     width: 400,\n//     align: 'center',\n//     normalStyle: {\n//         color: '#000',\n//         font: '42px Microsoft YaHei,sans-serif',\n//     },\n//     pos: {\n//         x: 160,\n//         y: 522,\n//     },\n// }).text('德才兼秀', {\n//     width: 316,\n//     align: 'center',\n//     normalStyle: {\n//         color: '#fff',\n//         font: '42px Microsoft YaHei,sans-serif',\n//     },\n//     pos: {\n//         x: 212,\n//         y: 658,\n//     },\n// }).draw({\n//     type: 'jpg',\n//     quality: .9,\n//     success(b64) {\n//         $result.attr('src', b64);\n//         console.log(mc1);\n//     },\n// });\n\n// let img = new Image();\n// img.onload = ()=>{\n    // mc.background({\n    //     image:'http://mtapplet.meitudata.com/596c72073971d86b5128.jpg',\n    //     left:0,\n    //     top:0,\n    //     color:'#000000',\n    //     type:'origin',\n    // }).add([{\n    //     image:'images/ear.png',\n    //     options:{\n    //         width:482,\n    //         pos:{\n    //             x:150,\n    //             y:58,\n    //             scale:1,\n    //             rotate:1,\n    //         },\n    //     },\n    // },{\n    //     image:'images/neck.png',\n    //     options:{\n    //         width:277,\n    //         pos:{\n    //             x:213,\n    //             y:557,\n    //             scale:1,\n    //             rotate:1,\n    //         },\n    //     },\n    // }]).add('images/nose.png',{\n    //     width:183,\n    //     pos:{\n    //         x:250,\n    //         y:369,\n    //         scale:0.84,\n    //         rotate:1,\n    //     },\n    // }).text('郭晓东<br><s>啊啊啊</s>我<br>我我<br><b>哦哦哦</b><s>啦啦啦</s>',{\n    //     width:'300px',\n    //     align:'center',\n    //     pos:{\n    //         x:0,\n    //         y:0,\n    //     },\n    // }).watermark(img ,{\n    //     width:'40%',\n    //     pos:'rightBottom',\n    // }).draw( b64 =>{\n    //     $('.js-result').attr('src',b64);\n    // });\n// };\n// img.src = 'images/watermark.jpg';\n"],"names":["obj1","obj2","type","isType","forin","k","v","vType","extend","i","length","image","loaded","error","img","Image","indexOf","crossOrigin","onload","onerror","src","tar","isObjFunc","cbk","loadImage","log","obj","hasOwnProperty","UA","window","navigator","userAgent","toLowerCase","IOS","test","IPAD","match","JSON","parse","stringify","name","Object","prototype","toString","call","split","replace","MCanvas","options","ops","_","canvas","ctx","queue","fn","data","_init","document","createElement","width","height","getContext","save","backgroundColor","setBgColor","background","bg","bgConfig","push","color","getImage","_background","fillStyle","fillRect","_getBgAlign","left","iw","cw","cropScale","rv","Math","abs","_getSize","ih","iRatio","cRatio","sx","sy","swidth","sheight","dx","dy","dwidth","dheight","top","drawImage","_next","rect","fillColor","strokeColor","strokeWidth","ch","_get","x","y","lineWidth","strokeStyle","beginPath","strokeRect","closePath","_resetCtx","circle","r","arc","PI","fill","stroke","setTransform","restore","watermark","pos","margin","position","add","def","isArr","forEach","_add","_handleOps","console","warn","cdx","cdy","cdw","cdh","crop","lsx","lsy","lsw","lsh","cratio","ldx","ldy","ldw","ldh","lcvs","lctx","_ratio","lctxScale","spaceX","spaceY","shrink","isIos8","round","map","translate","rotate","scale","tagName","naturalWidth","naturalHeight","offsetWidth","offsetHeight","ratio","maxLsw","maxLsh","cropx","cropy","cropw","croph","px","py","pr","ps","parseFloat","text","context","fontFamily","size","defaultStyle","option","deepCopy","parseContext","_parse","max","maxFont","maxFontSize","parseInt","font","_text","arr","result","value","splitTag","tmp","textArr","textId","style","line","lineHeight","getLineHeight","measureText","fontLength","tcvs","tctx","tdx","tdy","tdw","tdh","_getTextRectHeight","align","_fillText","originX","originY","lh","vlh","shadow","blur","offsetX","offsetY","textAlign","textBaseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","gradient","colorStop","x1","y1","x2","y2","grad","createLinearGradient","colorNum","addColorStop","lastLine","lastLineData","par","child","str","draw","_ops","b64","success","toDataURL","quality","shift","clear","clearRect","$sure","$","$params","$dialog","$result","$cancel","$clear","mc","timer","on","addClass","setTimeout","removeClass","hide","attr","addImageOps","addWmOps","addTextOps","addRectOps","addCircleOps","mcDraw","err","showDialog","tab","html","show","$this","val"],"mappings":"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"}